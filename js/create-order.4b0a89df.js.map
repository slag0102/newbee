{"version":3,"file":"js/create-order.4b0a89df.js","mappings":"sJAAA,IAAIA,EAAS,WAAkB,IAAIC,EAAIC,KAAKC,EAAGF,EAAIG,MAAMD,GAAG,OAAOA,EAAG,MAAM,CAACA,EAAG,cAAc,CAACE,YAAY,CAAC,gBAAgB,2BAA2B,gBAAgB,QAAQC,MAAM,CAAC,MAAQ,GAAG,MAAQ,OAAO,aAAa,IAAIC,GAAG,CAAC,aAAa,SAASC,GAAQ,OAAOP,EAAIQ,QAAQC,KAAK,QAAS,GAAEC,YAAYV,EAAIW,GAAG,CAAC,CAACC,IAAI,QAAQC,GAAG,WAAW,MAAO,CAACX,EAAG,WAAW,CAACG,MAAM,CAAC,KAAO,WAAW,KAAO,QAAS,EAACS,OAAM,OAAUZ,EAAG,mBAAmB,CAACG,MAAM,CAAC,KAAO,OAAO,KAAOL,EAAIe,KAAK,IAAMf,EAAIgB,OAAOV,GAAG,CAAC,MAAQ,SAASC,GAAQ,OAAOP,EAAIQ,QAAQC,KAAK,eAAgB,KAAIP,EAAG,IAAI,CAACe,YAAY,WAAW,CAACjB,EAAIkB,GAAG,MAAMlB,EAAImB,GAAGnB,EAAIoB,YAAYpB,EAAIqB,GAAIrB,EAAIsB,MAAM,SAASC,GAAM,OAAOrB,EAAG,WAAW,CAACU,IAAIW,EAAKC,QAAQnB,MAAM,CAAC,IAAMkB,EAAKE,WAAW,MAAQF,EAAKG,aAAa,MAAQH,EAAKI,UAAU,MAAQJ,EAAKK,gBAAiB,IAAE1B,EAAG,iBAAiB,CAACG,MAAM,CAAC,cAAc,OAAO,eAAe,qBAAqBC,GAAG,CAAC,OAASN,EAAI6B,UAAUnB,YAAYV,EAAIW,GAAG,CAAC,CAACC,IAAI,MAAMC,GAAG,WAAW,MAAO,CAACX,EAAG,IAAI,CAACe,YAAY,SAAS,CAACf,EAAG,OAAO,CAACe,YAAY,WAAW,CAACjB,EAAIkB,GAAG,UAAUhB,EAAG,OAAO,CAACe,YAAY,SAAS,CAACjB,EAAIkB,GAAG,IAAIlB,EAAImB,GAAGnB,EAAI8B,iBAAkB,EAAChB,OAAM,OAAUZ,EAAG,YAAY,CAAC6B,MAAO,CAAEC,OAAQ,OAAS3B,MAAM,CAAC,UAAY,GAAG,SAAW,UAAUC,GAAG,CAAC,mBAAmBN,EAAIiC,QAAQC,MAAM,CAACC,MAAOnC,EAAIoC,KAAMC,SAAS,SAAUC,GAAMtC,EAAIoC,KAAKE,CAAI,EAACC,WAAW,SAAS,CAACrC,EAAG,aAAa,CAACG,MAAM,CAAC,KAAO,OAAO,MAAQ,qBAAqBC,GAAG,CAAC,MAAQN,EAAIwC,YAAY,CAACxC,EAAIkB,GAAG,WAAWhB,EAAG,aAAa,CAACG,MAAM,CAAC,KAAO,UAAU,MAAQ,qBAAqBC,GAAG,CAAC,MAAQN,EAAIyC,YAAY,CAACzC,EAAIkB,GAAG,WAAW,IAAI,EAC7jD,EACGwB,EAAkB,G,UCkCtB,GACA3B,KAAAA,eACA4B,MAAAA,GACAC,UAEA,yCAEA,qCACAC,EAAAA,EAAAA,IAAAA,KAAAA,IAAAA,MAAAA,IACA,qBACA,wEACA,0BACA,4BAEA,KAEAC,EAAAA,EAAAA,IAAAA,KAAAA,QAAAA,MAAAA,IACA,qBACA,iBACA,GAGA,EACAC,OACA,OACAC,GAAAA,GACAjC,KAAAA,GACAC,MAAAA,GACAI,QAAAA,GACAgB,MAAAA,EACAa,WAAAA,GACAC,OAAAA,GACA5B,KAAAA,GACA6B,QAAAA,GACAC,QAAAA,EAEA,EACAC,QAAAA,CAEAxB,WAEA,wCAEA,uCAEAyB,EAAAA,EAAAA,IAAAA,KAAAA,QAAAA,UAAAA,KAAAA,YAAAA,MAAAA,IACA,qBAEA,oBACA,IAGA,YACA,EAEAd,YACA,gBACAe,EAAAA,EAAAA,IAAAA,KAAAA,QAAAA,KAAAA,SAAAA,MAAAA,IACA,qBACA,+BACA,4BACA,GAEA,EAEAd,YACA,gBACAc,EAAAA,EAAAA,IAAAA,KAAAA,QAAAA,KAAAA,SAAAA,MAAAA,IACA,qBACA,8BACA,4BAEA,GAEA,EAEAtB,SAEA,2BACA,GAEAuB,SAAAA,CAKA1B,aACA,gDACA,+BACA,IACA,IC9HoQ,I,UCQhQ2B,GAAY,OACd,EACA1D,EACA2C,GACA,EACA,KACA,WACA,MAIF,EAAee,EAAiB,O","sources":["webpack://myapp/./src/views/CreateOrder/CreateOrder.vue","webpack://myapp/src/views/CreateOrder/CreateOrder.vue","webpack://myapp/./src/views/CreateOrder/CreateOrder.vue?778d","webpack://myapp/./src/views/CreateOrder/CreateOrder.vue?8823"],"sourcesContent":["var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',[_c('van-nav-bar',{staticStyle:{\"border-bottom\":\"0.02667rem solid #dcdcdc\",\"margin-bottom\":\"10px\"},attrs:{\"fixed\":\"\",\"title\":\"生成订单\",\"left-arrow\":\"\"},on:{\"click-left\":function($event){return _vm.$router.push('/cart')}},scopedSlots:_vm._u([{key:\"right\",fn:function(){return [_c('van-icon',{attrs:{\"name\":\"ellipsis\",\"size\":\"18\"}})]},proxy:true}])}),_c('van-contact-card',{attrs:{\"type\":\"edit\",\"name\":_vm.name,\"tel\":_vm.phone},on:{\"click\":function($event){return _vm.$router.push('/addresslist')}}}),_c('p',{staticClass:\"address\"},[_vm._v(\"地址：\"+_vm._s(_vm.address))]),_vm._l((_vm.list),function(item){return _c('van-card',{key:item.goodsId,attrs:{\"num\":item.goodsCount,\"price\":item.sellingPrice,\"title\":item.goodsName,\"thumb\":item.goodsCoverImg}})}),_c('van-submit-bar',{attrs:{\"button-text\":\"生成订单\",\"button-color\":\"rgb(27, 174, 174)\"},on:{\"submit\":_vm.onSubmit},scopedSlots:_vm._u([{key:\"tip\",fn:function(){return [_c('p',{staticClass:\"total\"},[_c('span',{staticClass:\"shoping\"},[_vm._v(\"商品金额\")]),_c('span',{staticClass:\"money\"},[_vm._v(\"￥\"+_vm._s(_vm.totalMoney))])])]},proxy:true}])}),_c('van-popup',{style:({ height: '30%' }),attrs:{\"closeable\":\"\",\"position\":\"bottom\"},on:{\"click-close-icon\":_vm.cancel},model:{value:(_vm.show),callback:function ($$v) {_vm.show=$$v},expression:\"show\"}},[_c('van-button',{attrs:{\"type\":\"info\",\"color\":\"rgb(25, 137, 250)\"},on:{\"click\":_vm.payAlipay}},[_vm._v(\"支付宝支付\")]),_c('van-button',{attrs:{\"type\":\"primary\",\"color\":\"rgb(79, 192, 141)\"},on:{\"click\":_vm.wechatPay}},[_vm._v(\"微信支付\")])],1)],2)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n    <div>\r\n        <!-- 头部 -->\r\n        <van-nav-bar fixed title=\"生成订单\" left-arrow @click-left=\"$router.push('/cart')\"\r\n            style=\"border-bottom: 0.02667rem solid #dcdcdc;margin-bottom: 10px;\">\r\n            <template #right>\r\n                <van-icon name=\"ellipsis\" size=\"18\" />\r\n            </template>\r\n        </van-nav-bar>\r\n        <!-- 地址 -->\r\n        <van-contact-card type=\"edit\" :name=\"name\" :tel=\"phone\"\r\n            @click=\"$router.push('/addresslist')\">\r\n        </van-contact-card>\r\n        <p class=\"address\">地址：{{ address }}</p>\r\n        <!--  -->\r\n        <van-card v-for=\"item in list\" :key=\"item.goodsId\" :num=\"item.goodsCount\" :price=\"item.sellingPrice\"\r\n            :title=\"item.goodsName\" :thumb=\"item.goodsCoverImg\" />\r\n        <!-- 商品总金额 -->\r\n        <van-submit-bar button-text=\"生成订单\" @submit=\"onSubmit\" button-color=\"rgb(27, 174, 174)\">\r\n            <template #tip>\r\n                <p class=\"total\">\r\n                    <span class=\"shoping\">商品金额</span>\r\n                    <span class=\"money\">￥{{ totalMoney }}</span>\r\n                </p>\r\n            </template>\r\n        </van-submit-bar>\r\n        <van-popup v-model=\"show\" closeable position=\"bottom\" :style=\"{ height: '30%' }\" @click-close-icon=\"cancel\">\r\n            <van-button type=\"info\" color=\"rgb(25, 137, 250)\" @click=\"payAlipay\">支付宝支付</van-button>\r\n            <van-button type=\"primary\" color=\"rgb(79, 192, 141)\" @click=\"wechatPay\">微信支付</van-button>\r\n        </van-popup>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\nimport { getAddressDetail, saveOrder, cartSettle, Alipay } from \"@/api/index\"\r\n\r\nexport default {\r\n    name: \"createrorder\",\r\n    props: [],\r\n    created() {\r\n        // console.log(this.$route.query.cartItemId);\r\n        this.cartId = this.$route.query.cartItemId\r\n        // console.log(this.cartId);\r\n        this.id = this.$route.query.addressId;\r\n        getAddressDetail(this.id).then(data => {\r\n            if (data.resultCode === 200) {\r\n                this.address = data.data.provinceName + data.data.regionName + data.data.detailAddress\r\n                this.name = data.data.userName\r\n                this.phone = data.data.userPhone\r\n                // console.log(this.address);\r\n            }\r\n        }),\r\n            cartSettle(this.cartId).then(data => {\r\n                if (data.resultCode === 200) {\r\n                    this.list = data.data\r\n                }\r\n            })\r\n\r\n    },\r\n    data() {\r\n        return {\r\n            id: '',\r\n            name: '',\r\n            phone: '',\r\n            address: '',\r\n            show: false,\r\n            cartItemId: [],\r\n            cartId: [],\r\n            list: [],\r\n            orderNo: '',\r\n            payType: 0,\r\n        }\r\n    },\r\n    methods: {\r\n        // 生成订单\r\n        onSubmit() {\r\n\r\n            this.list != null ? this.list.forEach(item => {\r\n                // console.log(item);\r\n                this.cartItemId.push(item.cartItemId);\r\n            }) : 0\r\n            saveOrder(this.address.addressId, this.cartItemId).then(data => {\r\n                if (data.resultCode === 200) {\r\n                    // console.log(data.data);\r\n                    this.orderNo = data.data\r\n                }\r\n\r\n            })\r\n            this.show = true;\r\n        },\r\n        // 支付宝支付\r\n        payAlipay() {\r\n            this.payType = 1\r\n            Alipay(this.orderNo, this.payType).then(data => {\r\n                if (data.resultCode === 200) {\r\n                    this.$toast.success('支付宝支付成功');\r\n                    this.$router.push('/order')\r\n                }\r\n            })\r\n        },\r\n        // 微信支付\r\n        wechatPay() {\r\n            this.payType = 2\r\n            Alipay(this.orderNo, this.payType).then(data => {\r\n                if (data.resultCode === 200) {\r\n                    this.$toast.success('微信支付成功');\r\n                    this.$router.push('/order')\r\n\r\n                }\r\n            })\r\n        },\r\n        // 点击x和空白处\r\n        cancel() {\r\n\r\n            this.$router.push('/order')\r\n        }\r\n    },\r\n    computed: {\r\n        // list() {\r\n        //     return this.$store.state.cartList;\r\n        // },\r\n        // 计算总价\r\n        totalMoney() {\r\n            return this.list != null ? this.list.reduce((prev, next) => {\r\n                return prev + next.goodsCount * next.sellingPrice\r\n            }, 0) : 0\r\n        }\r\n    }\r\n}\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n/deep/.van-nav-bar .van-icon {\r\n    color: #252525;\r\n}\r\n\r\n.van-card {\r\n    margin-top: 0;\r\n    background-color: white;\r\n}\r\n\r\n.van-cell {\r\n    position: relative;\r\n    padding-top: 60px;\r\n    padding-bottom: 30px;\r\n    margin-bottom: 30px;\r\n}\r\n\r\n.address {\r\n    position: absolute;\r\n    top:100px;\r\n    left: 40px;\r\n    color: #323233;\r\n    font-size: 0.37333rem;\r\n}\r\n\r\n.van-card__content {\r\n    box-sizing: border-box;\r\n    padding: 10px 10px;\r\n}\r\n\r\n.van-card__price-currency,\r\n.van-card__price-integer {\r\n    color: red;\r\n    font-size: 18px;\r\n}\r\n\r\n/deep/.van-submit-bar__tip {\r\n    box-sizing: border-box;\r\n    padding: 0px 18px;\r\n}\r\n\r\n.total {\r\n    display: flex;\r\n    justify-content: space-between;\r\n\r\n    .shoping {\r\n        font-size: 15px;\r\n        color: #2c3e50;\r\n    }\r\n\r\n    .money {\r\n        color: red;\r\n        font-size: 18px;\r\n    }\r\n}\r\n\r\n.van-submit-bar__tip {\r\n    background-color: white;\r\n}\r\n\r\n.van-button {\r\n    width: 100%;\r\n    border-radius: 0px;\r\n}\r\n\r\n/deep/.van-overlay {\r\n    margin-top: 46px;\r\n}\r\n\r\n.van-popup--bottom {\r\n    display: flex;\r\n    flex-wrap: wrap;\r\n    justify-content: center;\r\n    align-items: center;\r\n    box-sizing: border-box;\r\n    padding: 45px 0px;\r\n\r\n    .van-button--normal {\r\n        width: 90%;\r\n    }\r\n}\r\n</style>","import mod from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./CreateOrder.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./CreateOrder.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./CreateOrder.vue?vue&type=template&id=7775caa8&scoped=true&\"\nimport script from \"./CreateOrder.vue?vue&type=script&lang=js&\"\nexport * from \"./CreateOrder.vue?vue&type=script&lang=js&\"\nimport style0 from \"./CreateOrder.vue?vue&type=style&index=0&id=7775caa8&prod&lang=less&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"7775caa8\",\n  null\n  \n)\n\nexport default component.exports"],"names":["render","_vm","this","_c","_self","staticStyle","attrs","on","$event","$router","push","scopedSlots","_u","key","fn","proxy","name","phone","staticClass","_v","_s","address","_l","list","item","goodsId","goodsCount","sellingPrice","goodsName","goodsCoverImg","onSubmit","totalMoney","style","height","cancel","model","value","show","callback","$$v","expression","payAlipay","wechatPay","staticRenderFns","props","created","getAddressDetail","cartSettle","data","id","cartItemId","cartId","orderNo","payType","methods","saveOrder","Alipay","computed","component"],"sourceRoot":""}